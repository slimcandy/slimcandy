---
date: 2022-10-11
title: Linting in Monorepo
description: Handle sharable ESlint, Prettier and Husky configs in mono repositories
icon: ðŸ—‚
category: JS
---

The article shows two possible methods of handling formatting and linting code in monorepos.

## Source code

[GitHub repository](https://github.com/slimcandy/monorepo-lint-example) has three branhces:

- _master_ - initial monorepo
- _package-method_
- _extend-method_

---

## Package method

Take linters as independent repositories. Apply them as if they were imported from NPM.

### Install

Add new packages via lerna.

`npx lerna create prettier-config --yes`

`npx lerna create eslint-config-react --yes`

### Configure

Only two files are necessary: _index.js_ and _package.json_.

#### Prettier

`cd packages/prettier-config`

`npm install --save-dev --save-exact prettier`

_packages/prettier-config/index.js_

```js
module.exports = {
  printWidth: 80
  // ... configuration
}
```

_packages/prettier-config/package.json_

```json
{
  "name": "@my-local-scope/prettier-config",
  "main": "index.js"
  // ... configuration
}
```

Wire it up with target project. Update its _package.json_ file.

```json
{
  "prettier": "@my-local-scope/prettier-config"
}
```

#### ESlint

`cd packages/eslint-config-react`

`npm init @eslint/config`

`npm install --save-dev eslint-config-prettier`

_packages/eslint-config-react/index.js_

```js
module.exports = {
  extends: ['plugin:react/recommended', 'airbnb', 'prettier']
  // ... configuration
}
```

_packages/eslint-config-react/package.json_

```json
{
  "name": "@my-local-scope/eslint-config-react",
  "main": "index.js"
  // ... configuration
}
```

Wire it up with target project. Update its _.eslintrc_ file.

```json
{
  "extends": ["@my-local-scope/eslint-config-react"]
}
```

### Update target project's _package.json_

```json
{
  "scripts": {
    "format": "prettier --write src/**/*.js",
    "lint": "eslint --fix src/**/*.js",
    "test": "npm run format && npm run lint"
  }
}
```

## Global extend method

### Install

[ESLint + Prettier](https://reactdeveloper.netlify.app/typescript-cra-eslint-airbnb-prettier) into root foder as if it's regular repository

### Extend

Import global configs

#### Prettier

Prettier can be extended [just from js file](https://prettier.io/docs/en/configuration.html#sharing-configurations).

_./.prettierrc.js_

```js
module.exports = {
  // ... configuration
}
```

_packages/app/.prettierrc.js_

```js
module.exports = {
  ...require('../../.prettierrc')
  // ... configuration
}
```

#### ESlint

_packages/app/.eslintrc_

```json
{
  "extends": "../../.eslintrc.json"
  // ... configuration
}
```

## Rebuild project

`npx lerna link`

`npx lerna bootstrap`

`npx lerna run build`

`npx lerna run test --scope=app`

## Husky

Install it

`npx husky-init && npm install`

Update pre-commit file

_./.husky/pre-commit_: Replace ~npm run test~ with `npx lerna run test --scope=my-app`

## Links

1. https://medium.com/reactbrasil/reuse-your-eslint-prettier-config-in-a-monorepo-with-lerna-54c1800cacdc
1. https://eslint.org/docs/latest/developer-guide/shareable-configs
1. https://prettier.io/docs/en/configuration.html#sharing-configurations
1. https://frontendmasters.com/courses/monorepos/
